<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <title>主畫面</title>
    <script>
        // 防止 Unity 遊戲太大時無回應，允許使用者等載入
        window.onload = function () {
            var iframe = document.getElementById("unityIframe");
            if (iframe) {
                //在網頁中 JavaScript 把 session cookie 傳給 Unity
                iframe.onload = function () {
                const cookie = document.cookie;
                iframe.contentWindow.postMessage({ type: "cookie", cookie: cookie }, "*");
                };
                iframe.style.width = "100%";
                iframe.style.height = "100%";
            }
        };
    </script>
    <style>
        #unityContainer {
            margin-top: 20px;
            border: 2px solid #ccc;
            width: 100%;
            height: 600px;
        }

        #errorMessage {
            color: red;
            font-weight: bold;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h2>歡迎 {{ username }}！</h2>
    <p>你的最高分：{{ high_score }}</p>
    
    <p>
        <a href="{{ url_for('home') }}">回到首頁</a>
        <a href="{{ url_for('logout') }}">登出</a>
    </p>

    <!-- Unity 遊戲區塊開始 -->
    <div id="unityContainer">
        <iframe id="unityIframe"
                src="{{ url_for('static', filename='webgl/index.html') }}?username={{ username }}&high_score={{ high_score }}"
                width="960" height="600" frameborder="0"></iframe>
    </div>
    <!-- Unity 遊戲區塊結束 -->
</body>
</html>
